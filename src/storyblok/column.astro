---
import { renderRichText } from "@storyblok/astro";
import { ColumnStoryblok } from "@types";
import { resolveStylesBlocks } from "storyblok/styles/resolveStyles";

const { blok } = Astro.props;

type Props = {
  blok: ColumnStoryblok;
};

const extractImgTag = (htmlString: string): string => {
  const regex = /<([^>]+)>(\s*<img[^>]*>\s*)(.*?)<\/\1>/g;
  return htmlString.replace(regex, "$2<$1>$3</$1>");
};

const renderedRichText = extractImgTag(renderRichText(blok.content));

const { classNames } = resolveStylesBlocks(blok?.styles);
---

<style>
  .column {
  }
</style>

<div class:list={["column", classNames]} set:html={renderedRichText} />
